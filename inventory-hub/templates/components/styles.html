<style>
    /* --- DARK MODE KIOSK THEME (Layout & Print Fix) --- */
    body { background-color: #000; color: #fff; font-family: 'Segoe UI', monospace; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
    
    /* Navigation */
    .navbar { height: 70px; background-color: #111; border-bottom: 2px solid #00d4ff; flex-shrink: 0; z-index: 100; }
    .navbar-brand { color: #00d4ff !important; font-weight: bold; font-size: 1.5rem; text-shadow: 0 0 10px rgba(0, 212, 255, 0.3); }
    
    /* Main Layout */
    .main-container { 
        height: calc(100vh - 70px); /* Full height minus navbar */
        display: flex; 
        flex-direction: column; /* STACK VERTICALLY */
        padding: 10px; 
        gap: 10px; 
        overflow: hidden; 
        position: relative; 
        z-index: 1; 
    }
    
    /* Content Row (Logs + Buffer) */
    .content-row {
        flex: 1; /* Takes all available space */
        display: flex; /* Side by side */
        gap: 10px;
        overflow: hidden;
        min-height: 0; 
    }
    
    .col-logs, .col-buffer { 
        flex: 1; 
        display: flex; 
        flex-direction: column; 
        background: #111; 
        border: 1px solid #333; 
        border-radius: 8px; 
        overflow: hidden;
    }
    
    /* Logs */
    .log-box { flex-grow: 1; overflow-y: auto; padding: 15px; font-family: 'Consolas', monospace; font-size: 1.1rem; color: #eee; }
    .log-INFO { color: #0f0; } .log-WARNING { color: #fc0; } .log-ERROR { color: #f44; }
    
    /* Buffer Zone */
    .buffer-header { padding: 15px; background: #222; border-bottom: 1px solid #333; color: #00d4ff; font-weight: bold; display: flex; justify-content: space-between; flex-shrink: 0; }
    .buffer-content { flex-grow: 1; overflow-y: auto; padding: 15px; }
    
    /* Command Deck - Pinned to Bottom */
    .cmd-deck { 
        height: 140px; 
        flex-shrink: 0;
        padding: 10px; 
        background: #1a1a1a; 
        border-top: 1px solid #333; 
        display: flex; 
        justify-content: space-around; 
        gap: 10px; 
        z-index: 10; 
        margin-top: auto; 
    }
    .deck-btn { 
        flex: 1; 
        background: #222; 
        border: 1px solid #444; 
        border-radius: 8px; 
        padding: 5px; 
        text-align: center; 
        cursor: pointer; 
        transition: 0.2s; 
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        justify-content: center; 
    }
    .deck-btn:active { background: #333; transform: scale(0.95); }
    .deck-qr { background: #fff; padding: 10px; border-radius: 4px; margin-bottom: 5px; border: 4px solid #fff; }
    .deck-label { font-weight: bold; font-size: 0.9rem; letter-spacing: 1px; }
    
    /* Chameleon Card Engine */
    .cham-card { border-radius: 12px; padding: 3px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
    .cham-body { background: #1a1a1a; border-radius: 9px; padding: 10px; display: flex; align-items: center; justify-content: space-between; min-height: 80px; }
    .cham-text-group { display: flex; align-items: center; flex-grow: 1; overflow: hidden; }
    .cham-id-badge { background: rgba(0,0,0,0.6); padding: 5px 10px; border-radius: 6px; font-family: 'Consolas', monospace; font-weight: bold; color: #fff; margin-right: 15px; border: 1px solid rgba(255,255,255,0.2); }
    .cham-text { font-size: 1.4rem; font-weight: bold; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    
    /* Actions & Buttons */
    .cham-actions { display: flex; gap: 10px; align-items: center; }
    .action-badge { background: #000; border: 2px solid #444; border-radius: 8px; padding: 5px; display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: 0.2s; min-width: 70px; }
    .action-badge:active { transform: scale(0.95); background: #333; }
    
    .badge-qr { background: #fff; padding: 8px; border-radius: 4px; margin-bottom: 3px; border: 3px solid #fff; }
    
    /* Colors */
    .badge-btn { background: none; border: none; font-weight: bold; font-size: 0.8rem; text-transform: uppercase; color: #fff; }
    .btn-pick { color: #00d4ff !important; border-color: #00d4ff; }
    .btn-print { color: #d633ff !important; border-color: #d633ff; }
    .btn-trash { color: #f44 !important; border-color: #f44; }
    
    /* Slots Grid */
    .slot-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 15px; margin-bottom: 20px; }
    .slot-btn { background: #222; border: 2px solid #444; border-radius: 10px; height: 180px; display: flex; flex-direction: column; align-items: center; justify-content: space-between; padding: 10px; cursor: pointer; position: relative; overflow: hidden; }
    .slot-btn.full { border-color: #00d4ff; background: #1a1a1a; }
    
    /* Modal Styling */
    .modal-content { background-color: #1a1a1a !important; color: #fff !important; border: 1px solid #444; }
    .table-dark { background-color: #1a1a1a; color: #fff; }
    .table-dark th, .table-dark td { color: #eee !important; border-color: #444; vertical-align: middle; }
    .modal-title { color: #00d4ff; font-weight: bold; }
    .qr-box { background: #fff; padding: 15px !important; border-radius: 8px; display: inline-block; }
    
    /* Utilities */
    .text-orange { color: #ff9900 !important; } .text-purple { color: #d633ff !important; }
    .status-dot { width: 12px; height: 12px; border-radius: 50%; display: inline-block; margin-right: 5px; }
    .status-on { background: #0f0; box-shadow: 0 0 5px #0f0; } .status-off { background: #f44; box-shadow: 0 0 5px #f44; }
    
    /* Overlays */
    #focus-guard { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 20000; display: none; justify-content: center; align-items: center; border: 20px solid #f44; text-align: center; }
    #processing-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 12000; display: none; }
    #processing-overlay::after { content: "PROCESSING..."; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #00d4ff; font-size: 3rem; font-weight: bold; text-shadow: 0 0 20px #00d4ff; }
    
    #toast-container { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 11000; text-align: center; width: 80%; max-width: 600px; pointer-events: none; }
    .toast-msg { background: rgba(0,0,0,0.95); color: #fff; padding: 30px; border: 4px solid #00d4ff; border-radius: 12px; font-size: 2rem; font-weight: bold; margin-bottom: 20px; animation: popIn 0.3s ease-out; }
    
    @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
    
    /* --- NEW: Buffer & Mode Styles --- */
    .buffer-actions { display: flex; align-items: center; gap: 10px; margin-left: 10px; }
    .buffer-qr { background: #fff; padding: 6px; border-radius: 4px; display: flex; align-items: center; justify-content: center; border: 2px solid white; }
    .buffer-qr img { display: block; } 
    .btn-buffer-x { font-size: 1.5rem; cursor: pointer; padding: 0 5px; opacity: 0.7; transition: 0.2s; color: #fff; }
    .btn-buffer-x:hover { opacity: 1; transform: scale(1.1); color: #f44; }

    /* Mode Indicators */
    .drop-mode-active { border-color: #ff9900 !important; box-shadow: 0 0 15px rgba(255, 153, 0, 0.4) !important; }
    .eject-mode-active { border-color: #f44 !important; box-shadow: 0 0 15px rgba(255, 68, 68, 0.4) !important; background-color: rgba(255, 68, 68, 0.1) !important; }
    .btn-audit-active { border-color: #d633ff !important; background-color: rgba(214, 51, 255, 0.2) !important; box-shadow: 0 0 15px rgba(214, 51, 255, 0.4) !important; }

    /* NOTE: @media print removed to prevent conflicts with label_spool.html */
</style>